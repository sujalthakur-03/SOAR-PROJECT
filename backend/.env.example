# OpenSearch Configuration
OPENSEARCH_NODE=https://localhost:9200
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=admin
OPENSEARCH_SSL_VERIFY=false

# JWT Secret for Authentication
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production
JWT_EXPIRES_IN=24h

# ═══════════════════════════════════════════════════════════════════
# Alert Ingestion Configuration
# ═══════════════════════════════════════════════════════════════════

# Alert Storage - Phase 2.0
# Enable persistent storage of alerts in OpenSearch
# When enabled, ingested alerts are stored in cybersentinel-alerts index
# Shadow mode for playbooks remains ACTIVE (no automated actions)
#
# ENABLE_ALERT_STORAGE=false (default) - Alerts logged only, not stored
# ENABLE_ALERT_STORAGE=true - Alerts written to OpenSearch
#
ENABLE_ALERT_STORAGE=false

# Alert Enrichment - Phase 2.1
# Enable background threat intelligence enrichment for stored alerts
# Requires ENABLE_ALERT_STORAGE=true to function
# Enriches alerts with IP reputation (AbuseIPDB) and file hash reputation (VirusTotal)
#
# ENABLE_ALERT_ENRICHMENT=false (default) - No enrichment
# ENABLE_ALERT_ENRICHMENT=true - Background enrichment enabled
#
ENABLE_ALERT_ENRICHMENT=false

# Playbook Matching - Phase 2.2
# Enable playbook matching for alerts (MATCHING ONLY, NO EXECUTION)
# Determines which playbooks apply to alerts based on conditions
# Shadow mode remains ACTIVE - playbooks are NOT executed
#
# ENABLE_PLAYBOOK_MATCHING=false (default) - No playbook matching
# ENABLE_PLAYBOOK_MATCHING=true - Match playbooks against alerts
#
ENABLE_PLAYBOOK_MATCHING=false

# Legacy Pull-Based Alert Ingestion (DEPRECATED)
# This feature polls CyberSentinel Manager for alerts.
# DISABLED by default in favor of push-based ingestion.
#
# To use push-based ingestion (RECOMMENDED):
#   Configure forwarder to POST to /api/v1/alerts/ingest
#
# To re-enable legacy pull (NOT RECOMMENDED):
#   Set ENABLE_LEGACY_PULL_INGESTION=true
#
ENABLE_LEGACY_PULL_INGESTION=false

# Wazuh Configuration (for Active Response Only - NOT for alert ingestion)
# NOTE: Alert ingestion now uses push-based /api/v1/alerts/ingest endpoint
# These settings are only used for active response actions (block IP, isolate host, etc.)
WAZUH_API_URL=https://your-wazuh-server:55000
WAZUH_API_USERNAME=your_wazuh_username
WAZUH_API_PASSWORD=your_wazuh_password
WAZUH_POLL_INTERVAL=10000

# Wazuh Indexer (OpenSearch) for Alert Queries (Optional)
WAZUH_INDEXER_URL=https://your-wazuh-indexer:9200
WAZUH_INDEXER_USERNAME=admin
WAZUH_INDEXER_PASSWORD=admin
WAZUH_ALERTS_INDEX=wazuh-alerts-*

# Cortex XSOAR Integration
CORTEX_API_URL=https://your-cortex-xsoar-server
CORTEX_API_KEY=your_cortex_api_key
CORTEX_VERIFY_SSL=false

# VirusTotal API (Phase 2.1 - Alert Enrichment)
# Used for file hash reputation lookups
# Free tier: 4 requests/minute
# Get your API key: https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=your_virustotal_api_key

# AbuseIPDB API (Phase 2.1 - Alert Enrichment)
# Used for IP reputation lookups
# Free tier: 1000 requests/day
# Get your API key: https://www.abuseipdb.com/account/api
ABUSEIPDB_API_KEY=your_abuseipdb_api_key

# Slack Integration
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token

# Email (SMTP) Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# Firewall API (Generic)
FIREWALL_API_URL=https://your-firewall-api
FIREWALL_API_KEY=your_firewall_api_key

# Server Configuration
PORT=3001
API_PORT=3002
LOG_LEVEL=info
NODE_ENV=development

# CORS Settings
CORS_ORIGIN=http://localhost:8080
